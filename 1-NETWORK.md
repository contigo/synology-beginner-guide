# 네트워킹과 보안지식
> 가정에서 개인서버 설치를 위한 필수 & 기본이 되는 내용을 다룹니다.

## 개요
라우터와 서버를 설치했을 때 이해하고 있어야만 하는 용어들은 아래와 같습니다.  
**라우터와 공유기**는 거의 같은 의미로 사용되고 있으니 편하게 이해해주세요!

- DHCP
- IP Address (IP주소)
- MAC Address(맥 어드레스)
- 내부망 & 외부망
- 게이트 웨이
- Port (구체적으로 포트 포워딩 Port forwarding)

````

이외에도 여러가지가 있겠지만.. 제가 몇년정도 운영해보니 
이정도는 (최소한) 숙지하고 있어야 문제가 생기거나 원하는 기능을 추가 할 때 
다른 강좌나 정보글을 봤을 때 이해를 하고 적용할 수 있었습니다.

해당 내용들은 일반인이 처음 네트워킹에 대한 개념을 이해하기 쉽게 하기 위해 
원래의 내용과 100% 일치하지 않는 부분이 있을 수 있으며
많은 부분이 생략되어 있음을 먼저 밝힙니다.

````

## 클라이언트
- 공유기에 연결되어 있는 기기들을 클라이언트라 칭합니다. 

## 서버 
- 이 문서에서는 우리의 나스를 서버로 칭합니다. (사실 공유기 입장에선 나스도 클라이언트 이기도 합니다.)

## DHCP
- **공유기 세팅화면**을 둘러보면 **DHCP 서버**라는 단어를 보신적이 있으리라 생각됩니다.
- 거의 모든 **공유기**는 **허브 + DHCP**로 이루어져 있습니다.
    - **허브**는 우리가 생각하는 인터넷 라인을 **여러갈래로 나눠주는 기능**을 말합니다. 
    - 또한 **허브** 라는 장비도 따로 존재합니다. 허브로는 네트워크를 구축 할 수는 없지요.
      - 라인 분배 기능만 담당합니다.
    - 보통 공유기의 WAN 단자에 유선 1라인을 꼽으면 유선 4라인으로 나눠주죠. 
      - 요즘 대부분 공유기는 무선도 공유기가 되고.. 이걸 **WIFI** 라고 부르지요.
    
- **DHCP**는 이렇게 유선 하나를 여러 라인으로 나눠주고 아이피를 할당해  **네트워크를 구축해주는 것**을 말합니다. (물론 무선도 해당 됩니다.)
- 가령 공유기 게이트웨이(관리자 혹은 세팅주소)인 [192.168.1.1] 은 192.168.1 대역에서 1번은 게이트 웨이를 뜻하며..
- 맨 뒤자리 2~255번은 그 네트워크에 속한 클라이언트(사용자)들을 뜻합니다.   
    - 1~255번인 이유는 아이피의 규칙 때문입니다. (하단 IP설명 참조)
    - ex) 192.168.1.2 ~ 192.168.1.255
- 보통 공유기의 DHCP란에서는 공유기의 네트워크 상의 사용자들(클라이언트)에 대한 아이피 할당 방법에 설정을 뜻합니다.
    - Static(고정) 혹은 Dynamic(유동)하게 아이피를 부여할 것인지 대한 설정이지요.
# 아이피 주소(IP Address)
- DHCP를 설명하다보면 자연스럽게 IP에 대한 설명이 필요하게 됩니다. 
- 네트워크상에서 컴퓨터를 찾는 방법입니다. 
- 다르게는 IP를 네트워크 상에서 일종의 주소지라고 비유하기도 합니다.
- IP의 형식은 최대 1~255까지의 수 4묶음으로 이루어져ㄷ 있습니다. 
    - ex) 8.8.8.8, 192.168.100.255 등등
# 내부망(inner line)
- DHCP란 에서 잠깐 등장했지만.. 공유기를 기준으로 연결된 네트워크망을 **내부망**이라고 칭합니다.
- 어떤 공유기에 나스와 컴퓨터와 여러 휴대폰, 태블릿이 연결되 있으면.. 같은 내부망에 접속해 있다 라고 합니다.
    - 이 내부망은 무선과 유선을 가리지 않습니다. 즉 랜선으로 꼽힌 PC와 WiFi로 연결된 노트북도 내부망에 묶인것입니다.
- 내부망 주소는 IP주소 형식에 따라 자유롭게 변경이 가능합니다만..
  - 보통은 라우터(공유기) 제조사들이 일정한 패턴을 기본값으로 정해둬서 정형화 되어있습니다.
    - ex) 192.168.0.1, 192.168.1.1, 172.30.1.254
- 내부망이라 칭하는 이유는.. 내부에서만 서로 연결이 가능한 네트워크이기 때문이겠지요?
    - 내 나스가 내부IP 192.168.1.11를 가질 때.
    - 같은 네트워크의 PC 혹은 태블릿에서 192.168.1.11 IP로 바로 접속이 가능합니다.
    - 하지만 다른 네트워크에서는 저 내부IP를 이용해 접근할 수 없습니다.
    - 이렇게 내부 아이피는 내부에서만 통용되는 IP주소입니다.
- 내부망에서 가지는 IP를 내부 아이피라고도 부릅니다. 
# 외부망(outer line)
- 흔히 우리가 알고 있는 인터넷입니다.
    - 쉽게 생각하면 외부망은 인터넷이라는 큰 네트워크로 이루어져 있다고 가정해서 생각해도 무방합니다.
- 쉽게 공유기를 기준으로 **바깥쪽** 망을 외부망이라 칭합니다.
- 주로 <http://ipipip.kr> 과 같은 사이트에서 외부망의 IP를 확인 할 수 있습니다.
    - 외부IP라고도 하며.. 대부분은 그냥 IP주소로 통칭합니다.
- 이 논리는 [216.58.193.78](http://216.58.193.78)의 구글IP 주소를 이용해 바로 접속이 가능함을 확인할 수 있습니다.

# 맥 어드레스(MAC Address)
- 클라이언트를 식별해주는 물리주소 값을 말합니다. 4바이트 크기로 이루어져 있습니다.
- 일정한 패턴을 가지지만 **고유 식별 값**입니다. 00~FF까지 두자리수 6묶음으로 이루어져 있습니다
  - ex) 00-11-22-A8-F1-BA, FF-F1-A0-AB-DB-C4 등등
- 맥 어드레스를 활용하여 공유기의 보안을 높힐 수 있습니다.
    - 가족 혹은 내가 허용 & 등록한 기기들의 맥 어드레스만 접속이 가능하게 할 수 있음.


# 게이트 웨이(Gateway)
- 자주 보실 내용은 아니지만.. 쉽게 이해하자면.. **서로 다른 네트워크로 통하는 첫번째 관문** 정도로 이해하면 됩니다.
- A가정과 B가정은 서로 다른 게이트 웨이로 이루어져 있고.. A가정에서 B가정으로 연결할 때 서로의 게이트 웨이를 통하게 됩니다.
- 이 저장소에서 이를 언급한 이유는 **사용자의 게이트 웨이 주소**가  주로 **공유기의 관리자 페이지 주소** 이기 때문입니다.

# 포트 Port (Port forwarding 포트포워딩)
- 포트는 컴퓨터안에서 프로그램을 찾는 방법입니다.
- 포트는 IP주소의 한계를 보완해주는 역할을 하기도 합니다.
- 서버(나스)는 파일 서버 이외에 프로그램들을 설치하고 활용 하게 되는데..
- 이때 아이피만으로 각각 다른 프로그램을 호출할 방법이 없게 되므로.. 
- 포트를 이용해 프로그램(프로토콜)을 구분할 수 있게 됩니다.
    - 가령 FTP는 21번 포트를 WEBDAV는 5005 포트를 갖습니다. 또 서버가 192.168.1.10 아이피라고 가정합니다.
    - FTP를 호출 한다면 **http://192.168.1.10:21**
    - WEBDAV를 호출한다면 **http://192.168.1.10:5005**
- 포트는 0\~65535를 사용하며 0~1023번까지는 예약된 포트로 사용되고 있습니다.

### 포트 포워딩

- 그렇다면 **포트포워딩**은 무엇 이길래.. 포트를 알아야하고 우리를 괴롭혔던 걸까요?
- 포트 포워딩은 공유기가 받은 포트를 어떻게 전달해줄지 정하는 규칙을 말합니다.
- 이렇게 적으니 이해가 어려워서 예를 들어보겠습니다.
    - 예시로 스타크래프트는 6112, 디아블로1은 6119 포트를 사용한다고 합니다.
    - 우리가 설치한 공유기 인터넷으로 스타크래프트를 제대로 즐기려면.. 6112 포트를 현재 PC에 포트포워딩 해야합니다.
    - 현재 PC는 192.168.1.8 입니다.
    - 만약 이런 포트 포워딩 과정을 제대로 하지 않고.. 스타크래프트에서 방을 만들면 아무도 들어오지 못하게 되죠. 
    - 우리는 스타크래프트를 즐기기 위해서 공유기에 6112포트가 통신할때 192.168.1.8의 6112 포트로 전달되게 설정을 해주면 됩니다.
        - 설정 방법은 공유기마다 조금씩 다르지만 왼쪽의 포트가 공유기 기준. 오른쪽이 포워딩될 목적지 입니다.
- 이렇게 공유기를 사용하게 되면.. 우리가 필요로 하는(사용할 포트)를 공유기 내부의 클라이언트(PC)로 포워딩을 해줘야 사용할 수 있다는 것을 의미합니다.
- 이는 우리가 시놀로지에 새로운 기능을 추가하거나 서버를 추가 할 때.. 이를 공유기에 포트 포워딩 해주지 않으면 외부와 제대로 통신 할 수 없게 됩니다.   
    - 이러한 번거로움을 UPnP라는 기능으로 조금은 편리하게 환경을 구축할 수 있습니다.

### 도메인과 DDNS
- DDNS를 이용한 방법은 두번째 챕터인 [**설치 직후 필요한 세팅**](https://github.com/liante0904/synology-beginner-guide/blob/master/2-AFTER_SETUP.md) 에서 자세히 설명되어 있습니다.
    - 도메인은 앞서 설명한 외부망편에서 구글을 접속할 때 아이피로 접속하지 않는 것과 연관이 있습니다.
    - 도메인이 IP주소를 대신하여 일정한 URL을 가지고 편리하게 접속하게끔 해주는 역할을 합니다.
    - 하지만 도메인을 일반인이 구매하고 등록하여 사용하는건 매우 어렵고 힘겨운 과정입니다.
- 이를 대체하기 위해 DDNS라는 것을 공유기 제조사들이 자체적으로 제공합니다.
- DDNS는 아이피가 유동적으로 바뀌어도 지정한 도메인을 이용해 접속할 수 있게 해주는 것을 말합니다.
    - 우리가 가정에 설치한 서버를 외부에서 접근하기 위해서는 공유기에 도메인을 부여해야 하는데.
    - 일반적인 도메인은 고정된 아이피에 사용되게 알맞습니다.
    - 하지만 대부분 가정집에서는 아이피가 유동적으로 바뀌기 때문에 도메인보다는 DDNS사용이 조금 더 알맞습니다.
    - 또한 DDNS는 공유기 제조사들이 무료로 제공하기 때문에 접근성이 더 높은 편입니다.
    - DDNS는 주로 공유기 제조사의 도메인을 이용하여 제공되어 집니다.
        - ex) asuscomm.com, iptime.org 등등

### DMZ

- DMZ는 하나의 아이피주소를 지정하게 되어 있고.. 이를 지정하게 되면 공유기에 요청되는 모든 포트를 지정한 IP로 넘깁니다.
- 굉장히 편리할 수 있지만.. 보안상 **모든 포트를 허용**하게 되므로 **적극 비추천** 하는 기능입니다.

### 참고
- DHCP 
  - <https://ko.wikipedia.org/wiki/%EB%8F%99%EC%A0%81_%ED%98%B8%EC%8A%A4%ED%8A%B8_%EA%B5%AC%EC%84%B1_%ED%94%84%EB%A1%9C%ED%86%A0%EC%BD%9C>

- 맥어드레스
  - <http://www.ktword.co.kr/abbr_view.php?nav=&m_temp1=2294&id=708>
