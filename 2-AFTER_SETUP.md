# 설치 직후 필요한 세팅

## 시놀로지를 외부망에서 사용하기

  - [정품 사용자를 위한 Synology의 QuickConnect 설정](https://www.synology.com/ko-kr/knowledgebase/SRM/help/SRM/RouterApp/internet_quickconnect)

시놀로지는 QuickConnect를 이용해 편리하게 외부 접근이 가능합니다.  
하지만 속도가 느리고 다소 불안한 점이 있어서 

1. **라우터의 DDNS** 을 이용한 방법
2. 도메인을 시놀로지에 도메인을 설치
등 여러 다른 대안을 소개 해보겠습니다.

## 공유기의 DDNS를 이용한 외부 접속 설정
``
공유기 제조사에서는 자체 DDNS 혹은 유료 DDNS를 무료로 사용할 수 있게 제공해줍니다.
주로 ipTIME과 ASUS가 있고 링크시스와 시스코 외 여러 제조사도 제공하고 있습니다.  
이를 이용해 서버를 외부접속가능하게 설정하려면 3가지의 설정이 필요합니다.
1. 나의 서버를 DHCP에서 고정 아이피로 할당되게 한다.
2. 사용할 기능을 포트포워딩 한다.
3. 나의 라우터에 도메인 혹은 DDNS를 설정한다.
포트 포워딩은 [네트워킹과 보안지식]을 참고해주시고.. 나머지 과정은 하단에 간단하게 소개 해보겠습니다.
``
### 공유기에서 나의 서버를 고정아이피로 할당(내부 DHCP)
1. 서버를 외부에서 사용하기 위해 여러가지 방법 중 하나의 패턴입니다.
    - 보통의 나스는 도메인을 구매해서 지정해 줄수 있고
    - 또 지금 하는 방법처럼 라우터에 DDNS를 사용하여 도메인으로 연결하는 방법도 있습니다.
2. ~~보통은 그럴일이 잘 없지만~~ 내부 아이피가 만약 바뀌어 버리게 되면 포트 포워딩이 틀어지는 문제를 방지하기 위함입니다. (물론 포워딩 했던 아이피로 고정해서 해도 되겠죠)
3. 라우터에 DHCP, DHCP 서버 란에서 아이피 고정 혹은 수동 할당에서
4. 맥 어드레스를 이용해 기기들을 구별하고 있을 것입니다.
5. 이전에 한번이라도 라우터에 접속했던 기기들의 목록이 보일텐데..
6. 서버의 DDNS를 찾아서 지정해주고 임의의 내부 아이피를 하나 지정해줍니다.
7. 공유기 혹은 서버를 재 시작했을 때.. 내가 지정해준 내부 아이피로 잘 할당되는지 확인해주면 끝입니다.

### **외부망에서 접근 가능한** 시놀로지 세팅하기 절차
  - 라우터 제조사의 DDNS를 활용한 방법
    - [ASUS 공유기의 DDNS 설정 방법](https://www.noip.com/support/knowledgebase/setting-ddns-asus-router/)
    - [ipTIME 공유기의 DDNS 설정 방법](http://iptime.com/iptime/?page_id=67&pageid=1&mod=document&keyword=ddns&uid=7307)
    - 이외의 대부분의 제조사에서도 DDNS를 제공하고 있습니다. **공유기 관리자 페이지(콘솔)** 에서 확인 해보세요!
1. 제조사에서 DDNS 설정 방법에 대해 안내하고 있는 페이지들입니다.
2. 이외에 제조사에서도 제공하고 대부분 제공하고 있으니.. 공유기 페이지에서 DDNS를 찾아서 설정 해주세요.
3. DDNS 설정 확인을 위해 지인 혹은 스마트폰의 WiFi 기능을 끄고 설정한 DDNS 주소를 접속했을 때, 공유기 설정 콘솔에 접근 할 수 있다면 성공입니다!


### 포트 포워딩 + DDNS + DHCP 고정 아이피 설정이 완료 되었을 때
1. 만약 올바르게 포트 포워딩에 대해 이해하고 있다면 DDNS와 포트로 접속 했을 때.. 사용자가 포워딩한 프로그램으로 연결됩니다.
    - 서버 192.168.1.10, Webdav(5005)포트로 가정한다면
    - 내부에서 192.168.1.10:5005 로 포트로 접근했을 때 내부에서 webdav는 별다른 설정없이도 접근이 가능합니다.
    - 외부에서 webdav를 접근하기 위해서는 DDNS + 포트 포워딩 두가지의 설정이 되어 있어야합니다.
        - DDNS는 **외부망 -> 라우터** 까지의 접근을 위한 설정이며
        - 포트 포워딩은 **라우터 -> 서버** 로의 접근을 위한 설정입니다.
        - 최종적으로 **외부망 -> 라우터 -> 서버** 의 과정을 통해 외부에서 서버로 접근 합니다.
    - 만약 외부 포트(라우터) 4000을 -> (내부)192.168.1.10의 5005 포트로 포워딩 해두었다면
    - 사용자는 http://myNAS-DDNS.add.ress:4000 으로 접속을 시도 했을 때
    - 내가 포트 포워딩한 192.168.1.10의 5005 프로그램(webdav)로 포워딩 됨을 확인할 수 있습니다.
2. 이것을 이해하지 못했거나.. 생각한대로 동작하지 않는다면 **네트워킹과 보안지식** 로 다시 이동해서 숙지해주세요.
3. 내부 포트와 외부 포트를 서로 같아도 무관하지만 **보안을 위해** `외부와 내부 포트를 다르게 설정`해주세요.
    - 보통 `내부 포트는 프로토콜에서 제공`하는 **기본 포트를 그대로 사용** 하며
    - `외부 포트를 사용자가 정의`하고.. 내부에 포워딩하는 식으로 세팅하여 사용하는 것이  **보편적인 패턴**입니다.



### SSL(HTTPS)
- [클리앙 철이씨님의 무료 duckdns를 시놀로지에 등록해 봅시다](https://www.clien.net/service/board/cm_nas/9177427)

### Reverse Proxy(역방향 프록시)
- [클리앙 명량중년님의 시놀로지 역방향 프록시로 port 번호 없이 사용하기](https://www.clien.net/service/board/cm_nas/10938224)
